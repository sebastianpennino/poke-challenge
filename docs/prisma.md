# Prisma

Prisma is an open-source database toolkit that simplifies database access with an auto-generated query builder for TypeScript and Node.js.

There's three important points to understand Prisma
- The prisma schema
- The migrations files
- The seeding data


## Prisma Schema
The Prisma Schema is the central file that defines the data model, relationships, and database configuration for our application:
- File Location: [schema.prisma](../prisma/schema.prisma)

### Key Components
- *Data Source:*
Defines the type of database and connection details.
Example: PostgreSQL, SQLite, MySQL, etc.

- *Generators:*
Specifies what Prisma should generate. Commonly used to generate the Prisma Client, which is an auto-generated, type-safe query builder (you will see it in the code imported as `from "@prisma/client"`)

- *Models:*
Represents the entities in the application. Each model **maps to a table in the database**.
Models include fields with types (e.g., `Int`, `String`, `Boolean`) and attributes (e.g., @id, @unique).

- *Relationships:*
Defines how models relate to each other, e.g., one-to-one, one-to-many, many-to-many.
Relationships are established using fields and special attributes like `@relation`.


## Migrations
After modifying the `schema.prisma` file, the database schema must be updated to reflect the changes. This is done using migrations.

### Creating a Migration
A migration is generated by running `npx prisma migrate dev --name foo-bar`


(Replace `foo-bar` with a descriptive name for the migration e.g., add-user-table, update-product-model).


This command generates a migration file inside the [prisma/migrations directory](../prisma/migrations/). The migration file contains SQL statements to update the database schema. You can now see the magic behind prisma üëÅÔ∏è_üëÅÔ∏è.

### Applying Migrations
The `npm run setup` command uses `npx prisma migrate deploy` that applies the migrations to the db and also seeds it with some data (see next section "Seeding the database")

### Reverting Migrations:
If you need to revert a migration, use `npx prisma migrate reset`. This command will reset the database to the last applied migration. Be cautious when using this, as it can result in data loss.


## Seeding the Database
Seeding involves populating the database with initial data:
- File Location: [seed.ts](../prisma/seed.ts)

The seed script can be run with `npx prisma db seed`. This command runs the `seed.ts` file and populates the database with the defined data (but as I said before `npm run setup` already takes care of it).


